# 机器学习

## 机器学习介绍

### 前言

从广义上来说，机器学习是一种能够赋予机器学习的能力以此让它完成直接编程无法完成的功能的方法。但从实践的意义上来说，机器学习是一种通过利用数据，训练出模型，然后使用模型预测的一种方法。

机器学习中有label 和 feature概念： label是分类，你要预测的东西，而feature则是特征(比如你通过一些特征黄色，圆，得出是月亮)。如果你训练出feature和label的关系，之后你可以通过feature得出label。

在机器学习领域，目前平台支持分类和回归两类模型；两类模型的功能区别如下：

分类：分类是根据样本特征对样本进行目标变量类别判定的过程，分类问题输出的值是离散的、定性的。

回归：预测是根据样本特征对样本进行目标变量预测的过程，回归问题输出的值是连续的、定量的。

下面是自动机器学习的技术文档。

### 应用场景

销售预测：通过机器学习技术对各方面影响因素的深入剖析和洞察，自动总结规律，精准预测产品和服务的销售情况，为库存规划、门店选址提供有力的依据。

销售预测：通过机器学习技术对各方面影响因素的深入剖析和洞察，自动总结规律，精准预测产品和服务的销售情况，为库存规划、门店选址提供有力的依据。

精准营销：挖掘客户潜在需求，以向真正有需求的客户推荐和销售产品，促成销售收入的提升。

### 使用流程

模型训练的基本流程如下所示



## 数据准备

### **创建数据集**

##### 数据集格式要求

- 数据集上传以zip包形式上传，zip包里面最多支持源文件和配置文件两个文件上传；源文件为训练数据，配置文件为训练数据对应的特征类型；
- 源文件仅支持csv、txt格式，配置文件支持上传arff格式；
- 配置文件列名需和源文件保持一致，若有无法匹配的特征或配置文件，则默认特征类型；
- 文件列名仅支持中文/英文/数字/下划线/中划线，长度在100个字符以内，且标题不能重复；
- 为保证结果准确度，建议数据集数据量不少于100条;

##### 创建数据集

1.顶部任务导航【数据管理】>【创建数据集】。

2.上传符合格式的压缩包，输入数据集名称，并设置文件解析所需要的信息。

3.确认好数据集上传所需要的内容后点击【文件解析】，开始解析数据集。

![image-20200512192430948](../../Library/Application%20Support/typora-user-images/image-20200512192430948.png)

 

4.上传数据集后的状态分为上传中、解压中、解析中三个状态，数据集相关信息在【数据管理】下的数据集中显示。为保证数据集正常解析，请按格式创建数据集。

解析中状态如下所示

![image-20200512195153992](../../Library/Application%20Support/typora-user-images/image-20200512195153992.png)

解析成功后的数据集可以正常参与训练。

![image-20200512200639771](../../Library/Application%20Support/typora-user-images/image-20200512200639771.png)

测试集上传过程同。



### 数据管理

在【数据管理】中，除了可以创建新的数据集之外，还可以对已上传的数据集进行查看、删除等操作。

![image-20200512195228394](../../Library/Application%20Support/typora-user-images/image-20200512195228394.png)

点击数据集操作中的【查看】，可查看数据集内容，若上传的数据集中包含配置文件，可以分别查看原文件和配置文件的信息。对于源文件内容，默认展示前500条，可支持跳转列的操作。

![image-20200512200800742](../../Library/Application%20Support/typora-user-images/image-20200512200800742.png)





## 模型管理

### 模型创建

在导航【模型中心】下点击【创建模型】，填写模型名称、模型归属、联系方式、功能描述等信息即可创建模型

![image-20200512201607032](../../Library/Application%20Support/typora-user-images/image-20200512201607032.png)



### 模型列表

模型创建成功后可以在【模型中心】下查看刚才创建的模型

![image-20200512201857479](../../Library/Application%20Support/typora-user-images/image-20200512201857479.png)



#### 模型版本查看

模型训练状态可以在【模型中心】下对应模型查看版本状态；训练完成的模型可进行发布、校验、或查看特征类型的操作；

![image-20200512202034772](../../Library/Application%20Support/typora-user-images/image-20200512202034772.png) 

训练完成后，点击【查看特征类型】可查看此版本训练集的特征统计分析结果。![image-20200512202151409](../../Library/Application%20Support/typora-user-images/image-20200512202151409.png)

点击版本号下拉，可看到模型详细的模型评估报告；见下【模型评估结果】



#### 模型评估结果

在这个部分可以看到模型训练整体的情况说明。这部分模型效果的指标是基于训练数据集，随机抽出部分数据不参与训练，仅参与模型效果评估计算。所以当数据量较少时（如样本数量低于50个），参与评估的数据可能不超过10个，这样得出的模型评估报告效果仅供参考，无法完全准确体现模型效果。

注意：若想要更充分了解模型效果情况，您可以发布模型为API后，通过调用接口批量测试，获取更准确的模型效果。

查看模型评估结果时，需要思考当前的业务场景，本平台支持分类和回归两种任务类型供选择。任务类型不同对应的模型指标不同。

每种训练类型下分为模型指标和模型解释两部分。

下面是基于分类的模型评估效果。左上角的8个模型指标是根据右上角此次训练效果统计混淆矩阵得来的。坐下一次为roc曲线，预测分布图及累计图；鼠标在预测分布图中滑动时，有一条橙色的竖线跟随，显示随着x轴阈值变化，对应混淆矩阵中各个值也随着变动。



![image-20200512202315731](../../Library/Application%20Support/typora-user-images/image-20200512202315731.png)



下面是基于回归的模型评估效果，回归的评估指标包含MSE、RMSE、MAE、MAPE四个，右侧为回归的残差图

![image-20200512204433700](../../Library/Application%20Support/typora-user-images/image-20200512204433700.png)

下面为通用的模型解释，按照特征重要度降序排列；默认显示前50条，可修改。

![image-20200512205748928](../../Library/Application%20Support/typora-user-images/image-20200512205748928.png)

## 模型训练

【模型训练】可以通过【模型中心】下模型版本列表中【训练新版本】即可训练模型。模型训练可以分为两步：「上传数据」和「模型训练」。

### 上传数据

上传训练集有两种形式，分为为「上传数据」和「选择已有数据」。由于上传数据同数据集上传时保持一致，所以在这里以「选择已有数据」举例。

![image-20200512210436454](../../Library/Application%20Support/typora-user-images/image-20200512210436454.png)

选择已有数据后点击【文件预览】可以先预览已选数据集解析是否有问题及确认训练集，若有问题可以通过点击【重新选择】选择其他数据集。

确定预览后点击【确定并训练】开始进入到模型训练步骤。

![image-20200512210727719](../../Library/Application%20Support/typora-user-images/image-20200512210727719.png)



进入到「模型训练」步骤后，需要先选择训练目标，选择完毕后右侧会显示训练目标对应的统计画像。

![image-20200513145608477](../../Library/Application%20Support/typora-user-images/image-20200513145608477.png)



点击下方特征列表中的特征可以查看对应特征的统计分析，根据特征的分布情况辅助判断特征是否适合参与模型训练。特征统计画像分为两种，对于离散型特征使用饼图统计，连续型特征使用箱线图和直方图表示分析结果。

![image-20200513150006266](../../Library/Application%20Support/typora-user-images/image-20200513150006266.png)

![image-20200513145403235](../../Library/Application%20Support/typora-user-images/image-20200513145403235.png)

在确定好训练集特征统计分析后，点击【启动训练】开始训练。



### 模型训练

点击【开始训练】，则开始训练模型；开始训练之后会跳转到相对应的模型下的版本列表中查看训练状态；

训练时间与数据量大小有关，请耐心等待。

![image-20200512213712090](../../Library/Application%20Support/typora-user-images/image-20200512213712090.png)

训练中的模型也可以停止训练，点击操作中的【停止训练】可停止训练；

 

## 模型预测

#### 上传数据

训练后的版本可以通过模型版本列表操作栏中点击【预测】即可校验当前版本的模型。

![image-20200513150336542](../../Library/Application%20Support/typora-user-images/image-20200513150336542.png)

预测步骤和模型训练第一步「上传数据」一致，需要先上传测试集或者选择已有测试集进行测试，选择好数据集后点击【文件解析】开始解析数据。

![image-20200513150719211](../../Library/Application%20Support/typora-user-images/image-20200513150719211.png)

解析完成后先预览测试集，确定测试集是否与本地文件保持一致。确定完成后，点击【确定并预测】开始预测。

![image-20200513150850261](../../Library/Application%20Support/typora-user-images/image-20200513150850261.png)



#### 预测结果返回

预测成功之后会返回预测结果，预测结果及置信度会提到列表前两列。

![image-20200513151043709](../../Library/Application%20Support/typora-user-images/image-20200513151043709.png)

 在预测结果页，点击右上角【导出为CSV文件】可以导出预测结果。导出预测结果可以选择想要导出的特征。特征选择分为特征筛选和按照特征重要度两种维度进行筛选。下图展示按特征重要度筛选；当特征过多时，可以通过填写重要度，选出想要的特征数据。

![image-20200513151331708](../../Library/Application%20Support/typora-user-images/image-20200513151331708.png)



## 模型发布

### 总体说明

训练完成后，可将模型部署在云服务、离线服务。

训练完成的模型被打包成适配智能硬件的SDK，可进行设备端离线计算。满足推理阶段数据敏感性要求、更快的响应速度要求。

云服务发布需要添加服务名称、接口地址、或可添加其他要求。接口地址不可重复。

云服务提交申请之后会跳转至对应模型下【版本列表】，查看发布状态，发布状态为【已发布】可对该模型进行【服务详情】查看或者【下线】。

![image-20200512213533819](../../Library/Application%20Support/typora-user-images/image-20200512213533819.png)

离线服务：离线SDK支持Windows和Linux操作系统。

![image-20200512213614287](../../Library/Application%20Support/typora-user-images/image-20200512213614287.png)

### 详细说明

#### 云发布

##### 发布图像分类API

##### API调用文档



#### 离线发布

##### 发布设备端SDK


##### Windows SDK集成文档



本章节介绍 Windows SDK的使用方法。

 * 硬件支持：
    * CPU x86_64
    * Nvidia GPU
 * 操作系统支持
    * Windows 10 
 * 环境依赖（必须安装以下版本）
    * Visual C++ Redistributable Packages for Visual Studio 2015
 * GPU依赖（必须安装以下版本）
    * CUDA 10.x + cuDNN 7.x
 * 协议
    * HTTP


快速开始

* 1. 安装依赖


    Visual C++ Redistributable Packages for Visual Studio 2015
    ```
    https://www.microsoft.com/zh-cn/download/details.aspx?id=48145
    ```

    如果使用GPU版SDK，请安装CUDA 10.x + cuDNN 7.x
    ```
    https://developer.nvidia.com

    https://developer.nvidia.com/cudnn 
    ```

* 2. 运行离线SDK


    解压下载好的SDK，打开 .exe 快捷方式

    本地服务默认运行在
    ```
    http://127.0.0.1:8987/upload
    ```
    浏览器打开该地址，上传文件。



##### Linux SDK集成文档

本章节介绍 Linux SDK的使用方法。

 * 硬件支持：
    * CPU x86_64
    * Nvidia GPU
 * 操作系统支持
    * ubuntu 16.04/18.04 

 * GPU依赖（必须安装以下版本）
    * CUDA 10.x + cuDNN 7.x
 * 协议
    * HTTP


快速开始

* 1. 安装依赖


    Visual C++ Redistributable Packages for Visual Studio 2015
    ```
    https://www.microsoft.com/zh-cn/download/details.aspx?id=48145
    ```

    如果使用GPU版SDK，请安装CUDA 10.x + cuDNN 7.x
    ```
    https://developer.nvidia.com/

    https://developer.nvidia.com/cudnn 
    ```

* 2. 运行离线SDK


    解压下载好的SDK，打开可执行环境

    本地服务默认运行在
    ```
    http://0.0.0.0:8987/upload
    ```
    浏览器打开该地址，上传文件。

